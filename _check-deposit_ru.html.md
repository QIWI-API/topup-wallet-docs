# Проверка возможности проведения платежа {#check-deposit}

###### Последнее обновление: 2020-07-14 | [Редактировать на GitHub](https://github.com/QIWI-API/topup-wallet-doc/blob/master/_check-deposit_ru.html.md)

Данным запросом вы должны проверить, возможно ли проведение платежа для пополнения учетной записи клиента в системе QIWI Wallet.

Если вам необходима только проверка регистрации учетной записи, то используйте [этот запрос](#check-user).

## Формат запроса {#deposit-req}

### Параметры запроса

~~~xml
<?xml version="1.0" encoding="utf-8"?>
<request>
  <request-type>check-deposit-possible</request-type>
  <terminal-id>123</terminal-id>
  <extra name="password">XXXXX</extra>
  <extra name="phone">79031234567</extra>
  <extra name="income_wire_transfer">1</extra>
</request>
~~~

Тег|Описание
--------|------
*request*|Группирующий тег
*request-type* | Тип запроса (идентификатор запроса проверки возможности проведения платежа: `check-deposit-possible`).
*terminal-id* | Идентификатор агента в системе QIWI Wallet.
*extra name="password"* | Экстра-поле, содержащее пароль для аутентификации агента в системе QIWI Wallet.
*extra name="phone"* | Экстра-поле, содержащее номер телефона клиента.
*extra name="income_wire_transfer"* | Экстра-поле, содержащее целочисленный признак безналичных (1) или наличных (0) средств, полученных от клиента для пополнения его учетной записи в системе QIWI Wallet.
*extra name="ccy"* | Экстра-поле, содержащее код валюты учетной записи клиента. Опциональный параметр. В случае его передачи проверяется возможность проведения платежа для пополнения учетной записи в данной валюте. В качестве значения используется цифровой или буквенный код валюты по ISO 4217.

## Формат ответа {#deposit-res}

<aside class="success">Если вы не уверены в корректной расшифровке ответа API, обратитесь в Службу поддержки: <a href="mailto:bss@qiwi.com">bss@qiwi.com</a>.</aside>


### Ответ без ошибок обработки запроса

Если запрос обработан корректно, то в ответе возвращаются сведения о возможности проведения платежа.

> Пример ответа - проведение платежа возможно

~~~xml
<?xml version="1.0" encoding="utf-8"?>
<response>
  <result-code fatal="false">0</result-code>
  <exist>1</exist>
  <deposit-possible>1</deposit-possible>
</response>
~~~

> Пример ответа - проведение платежа невозможно

~~~xml
<?xml version="1.0" encoding="utf-8"?>
<response>
    <result-code fatal="true" message="Недостаточный статус идентификации кошелька для проведения платежа" msg="Недостаточный статус идентификации кошелька для проведения платежа">204</result-code>
    <exist>1</exist>
    <deposit-possible>0</deposit-possible>
</response>
~~~

Параметры ответа:

 Тег|Описание|Атрибуты
--------|------|---------
*result-code* | [Код ошибки обработки запроса](#tech_error).| `fatal` – логический признак фатальности ошибки обработки запроса.
*exist* | Целочисленный флаг, указывающий на существование учетной записи клиента в системе QIWI Wallet. Флаг передается в ответе только в случае удачной обработки запроса (с кодом ошибки 0). Флаг может принимать значения:<br>`0` – учетная запись клиента не зарегистрирована в системе QIWI Wallet (в случае если в исходном запросе указана валюта (тег `<extra name="ccy">`), это означает, что у клиента нет учетной записи в данной валюте);<br>`1` – учетная запись клиента зарегистрирована в системе QIWI Wallet (в случае если в исходном запросе указана валюта (тег `<extra name="ccy">`), это означает, что клиент имеет учетную запись в данной валюте).|Отсутствуют.
*deposit-possible* | Целочисленный флаг, указывающий на возможность пополнения учетной записи клиента в системе QIWI Wallet. Флаг передается в ответе только в случае удачной обработки запроса (с кодом ошибки 0). Флаг может принимать значения:<br>`0` – учетную запись клиента нельзя пополнить указанным в запросе типом средств. **[Платеж](#payment) будет отклонён**.<br>`1` – учетную запись клиента можно пополнить указанным в запросе типом средств. | Отсутствуют.

### Ответ с ошибками обработки запроса

Если сервер не смог обработать запрос, API возвращает ответ с кодом произошедшей ошибки.

~~~xml
<?xml version="1.0" encoding="utf-8"?>
<response>
    <result-code fatal="false" message="Неизвестная ошибка" msg="Неизвестная ошибка">300</result-code>
</response>
~~~

Параметры ответа:

 Тег|Описание|Атрибуты
--------|------|---------
*result-code* | [Код ошибки обработки запроса](#tech_error)| `fatal` – логический признак фатальности ошибки обработки запроса;<br>`message`, `msg` - текстовое описание ошибки.
